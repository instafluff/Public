const e=new URLSearchParams(location.search);window.WebFontConfig={google:{families:["Poppins"]},active(){Unicorn.Create("unicorn-display",{width:1280,height:720,background:e.get("overlay")?"transparent":7829367,init:l,update:h,channel:e.get("channel"),username:e.get("username"),password:e.get("password"),onCommand:m,onChat:d,wallBottom:!0,wallLeft:!0,gravity:{x:0,y:1}})}},function(){const e=document.createElement("script");e.src=`${"https:"===document.location.protocol?"https":"http"}://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js`,e.type="text/javascript",e.async="true";const n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}();var n={},o={},t={},a=null,i=!1,s=null,r=[{chance:80,image:"pigeon"},{chance:1,image:"pigeonBlue"},{chance:1,image:"pigeonGreen"},{chance:1,image:"pigeonLemon"},{chance:1,image:"pigeonLightPurple"},{chance:1,image:"pigeonMint"},{chance:1,image:"pigeonOrange"},{chance:2,image:"pigeonPink"}],c=[{chance:30,image:"pigeon"},{chance:1,image:"pigeonXmas"},{chance:5,image:"pigeonGizmo"},{chance:8,image:"pigeonLara"},{chance:3,image:"pigeonHalloween"},{chance:10,image:"pigeonBlue"},{chance:10,image:"pigeonGreen"},{chance:10,image:"pigeonLemon"},{chance:10,image:"pigeonLightPurple"},{chance:10,image:"pigeonMint"},{chance:10,image:"pigeonOrange"},{chance:20,image:"pigeonPink"},{chance:1,image:"pigeonRainbow"},{chance:5,image:"pigeonHeart"}];function g(e){var n=[];return e.forEach(e=>{for(var o=0;o<e.chance;o++)n.push(e.image)}),n[b(n.length)]}function p(e,o,a,i){if(!n[e]){s&&clearTimeout(s),s=setTimeout(()=>{location.reload()},9e4);var r=Math.PI/4-Math.PI/10+Math.random()*Math.PI/10,c=10+Math.min(20,i);t[e]=Unicorn.AddObject("para_"+e,{type:"rectangle",x:1400,y:600,width:128,height:128,sprite:"parachute"}),t[e].isSensor=!0,t[e].sprite.visible=!1;var g=Unicorn.AddObject("pigeon_"+e,{type:"circle",x:1400,y:600,radius:20,sprite:a});g.sprite.scale.x=.5,g.sprite.scale.y=.5,g.sprite.anchor.set(.5);var p=Unicorn.AddText("label_"+e,e.toUpperCase(),1400,-190,{fontFamily:"Poppins",fontSize:14,fontWeight:"bold",fill:"#ffffff"});p.anchor.set(.5),g.name=e,Matter.Body.setVelocity(g,{x:c*Math.cos(r-Math.PI),y:c*Math.sin(r-Math.PI)}),n[e]={text:p,object:g}}}function l(){Unicorn.Load("pigeon","assets/pigeon.png"),Unicorn.Load("pigeonXmas","assets/starletCuteXmas.png"),Unicorn.Load("pigeonGizmo","assets/starletGizmo.png"),Unicorn.Load("pigeonLara","assets/starletLara.png"),Unicorn.Load("pigeonBlue","assets/starletPigeonBlue.png"),Unicorn.Load("pigeonGreen","assets/starletPigeonGreen.png"),Unicorn.Load("pigeonHalloween","assets/starletPigeonHalloween.png"),Unicorn.Load("pigeonHeart","assets/starletPigeonHeart.png"),Unicorn.Load("pigeonLemon","assets/starletPigeonLemon.png"),Unicorn.Load("pigeonLightPurple","assets/starletPigeonLightpurple.png"),Unicorn.Load("pigeonMint","assets/starletPigeonMint.png"),Unicorn.Load("pigeonOrange","assets/starletPigeonOrange.png"),Unicorn.Load("pigeonPink","assets/starletPigeonPink.png"),Unicorn.Load("pigeonRainbow","assets/starletPigeonRainbow.png"),Unicorn.Load("flower","assets/flower.png"),Unicorn.Load("parachute","assets/parachute.png"),function(){if(!i){i=!0;var e=100+b(800),o=600-b(400);(a=Unicorn.AddObject("flower",{type:"circle",x:e,y:o,radius:20,sprite:"flower",bounce:.9,isStatic:!0,onEnter:(e,o)=>{var t=a.position.x-o.position.x,i=a.position.y-o.position.y,s=Math.sqrt(t*t+i*i)<42;for(var r in n)if(e===n[r].object.label){if(s){let e=Unicorn.AddParticles("flowerExplosion",{shape:"circle",startColor:"#E76DC3",endColor:"#FCCCEE",blendMode:PIXI.BLEND_MODES.OVERLAY,intensity:10,minSpeed:.1,maxSpeed:.15,decay:1},a.position.x,a.position.y);setTimeout(()=>{Unicorn.RemoveParticles(e.name)},100),Unicorn.RemoveObject("flower"),a=null,ComfyJS.Say(r+" grabbed the flower!"),ComfyJS.Say("!starlights add "+r+" 1")}break}}})).sprite.scale={x:.5,y:.5},a.sprite.anchor.set(.5),a.isSensor=!0}}()}function h(e,a){for(var i in n){var s=n[i];if(s.text.x=s.object.position.x,s.text.y=s.object.position.y-45,Matter.Body.setPosition(t[s.object.name],{x:s.object.position.x+5,y:s.object.position.y-40}),t[s.object.name].angle=10*Math.sin(s.object.position.y/20)*(2*Math.PI/360),s.object.velocity.y>0&&(s.object.position.y>410&&(s.object.frictionAir=.5,t[s.object.name].sprite.visible=!0),s.object.position.y>650)){if(Math.abs(s.object.position.x-640)<128&&!o[s.object.name]){var r=(128-Math.abs(s.object.position.x-640)).toFixed(2);o[s.object.name]=r,console.log(Object.keys(o)),Object.keys(o).sort((e,n)=>o[n]-o[e])}Matter.Body.setVelocity(s.object,{x:0,y:0}),s.object.isStatic=!0,s.object.isSensor=!0,Unicorn.RemoveObject("para_"+s.object.name)}}}function m(e,n,o,t,a){(t.broadcaster||t.mod)&&"resetdrop"===n&&location.reload(),n.match(/^we[e+]/)&&(t.subscriber?p(a.username,0,g(c),n.length):p(a.username,0,g(r),n.length))}function d(e,n,o,t,a){n.toLowerCase().match(/^we[e+]/)&&(o.subscriber?p(a.username,0,g(c),n.split(" ")[0].length):p(a.username,0,g(r),n.split(" ")[0].length))}function b(e){return Math.floor(Math.random()*Math.floor(e))}